package main

import (
	"bufio"
	"fmt"
	"os"
	"strings"

	"github.com/sirupsen/logrus"

	"github.com/ferux/phraseGen"
	"github.com/ferux/phraseGen/markov"
	"github.com/ferux/phraseGen/utils"
)

var (

	// l is for logger
	l = logrus.New().WithFields(logrus.Fields{
		"Version":  phraseGen.Version,
		"Revision": phraseGen.Revision,
	})
)

const story = `Наша семья владела небольшим поместьем в Ноттингемшире; я был третьим из пяти сыновей. Отец отправил меня, четырнадцатилетнего, в колледж Св. Эммануила в Кембридже, и на протяжении двух с половиной лет я усердно грыз гранит науки. Однако моему отцу, имевшему весьма скромное состояние, стало трудно оплачивать обучение, и он забрал меня из колледжа. Было решено продолжить мое образование у мистера Джеймса Бетса, знаменитого лондонского хирурга. Там я и прожил следующие четыре года. Небольшие деньги, которые изредка посылал мне отец, я тратил на изучение навигации и математики – мне очень хотелось в будущем стать путешественником. Медицинское образование я завершил в городе Лейдене, где провел более двух лет; вся моя родня – в особенности отец и дядя Джон – помогали в осуществлении моей мечты: стать судовым врачом и посвятить жизнь дальним морским странствиям.
По возвращении из Лейдена я, по рекомендации моего доброго учителя мистера Бетса, нанялся хирургом на судно «Ласточка», ходившее под командованием капитана Авраама Паннелла. С ним я проплавал три с половиной года, совершив несколько путешествий в Левант и другие страны.
Вернувшись в Англию, я принял решение на время поселиться в Лондоне и поработать практикующим врачом, что одобрил и мистер Бетс, который всячески мне содействовал в этом начинании. Пациентов я принимал в небольшом доме неподалеку от Олд-Джюри, где проживал и сам, дела мои пошли неплохо, и вскоре я женился на мисс Мери Бертон, младшей дочери мистера Эдмунда Бертона, чулочного торговца с Ньюгейт-стрит. Моя невеста была милой и разумной девушкой с приданым в четыреста фунтов стерлингов.
Спустя два года доктор Джеймс Бетс умер; друзей в Лондоне у меня оставалось немного, заработок мой значительно сократился. Совесть не позволяла мне подражать шарлатанству некоторых моих коллег, и я начал подумывать о прекращении медицинской практики. Посоветовавшись с женой и знающими людьми, я решил снова отправиться в море.
Я был хирургом сперва на одном, а потом на другом торговом судне и в продолжение шести лет совершил несколько путешествий в Ост– и Вест-Индию, что несколько поправило мое финансовое положение. Уходя в море, я запасался книгами и все свободное время посвящал чтению; на берегу же изучал нравы, обычаи и языки туземцев, что при моей отличной памяти давалось мне легко. Последнее из этих плаваний было не слишком удачным, и я, утомленный морскою жизнью, решил больше не покидать жену и детей.
Мы перебрались из Олд-Джюри на Феттер-лейн и уже оттуда в Уоппин, поближе к гавани, где я надеялся рано или поздно получить выгодное предложение, но эта надежда оправдалась не скоро. Спустя три года мне наконец повезло – капитан Уильям Причард, хозяин судна «Антилопа», предложил мне место на своем корабле. Четвертого мая 1669 года мы снялись с якоря в Бристоле, и начало нашего плавания в южные широты Тихого океана оказалось в высшей степени удачным.
Однако при переходе от Магелланова пролива к Ост-Индии наше судно было отброшено страшной бурей к северо-западу от Вандименовой Земли. Двенадцать членов экипажа умерли, здоровье остальных было подорвано переутомлением и скверной пищей. Пятого ноября – в Южном полушарии как раз начиналось лето – стоял густой туман, но сильный ветер не утихал, и вахтенный слишком поздно заметил опасность. Корабль швырнуло на скалы, и он мгновенно разбился в щепки.
Шестерым из экипажа, и мне в том числе, удалось спустить шлюпку, чтобы попытатся добраться до берега. Сидя на веслах, мы отчаянно боролись с волнами на протяжении трех миль, пока с севера не налетел шквал, опрокинувший нашу лодку. Я вынырнул и поплыл к видневшейся в отдалении земле, подгоняемый ветром и приливом. Что случилось с моими товарищами, как и с теми, кто тщетно искал убежища на скалах, о которые разбился наш корабль, мне так и осталось неизвестным…
По мере того как приближалась земля, волны становились все меньше, ветер стихал. Наконец мои ноги коснулись дна, но пришлось брести по воде более мили, прежде чем я выбрался на берег. По моим предположениям, это случилось около девяти часов вечера. Превозмогая слабость, я прошел еще около полумили, но так и не увидел никаких признаков жилья. Я очень устал, ноги отказывались мне служить, меня одолевал сон. В конце концов я улегся на короткую шелковистую траву и заснул так крепко, как не спал никогда в жизни.
Когда я проснулся, было уже совсем светло. Однако ни подняться, ни сдвинуться с места я не смог. Я уснул на спине, а теперь оказалось, что руки и ноги словно прикованы к земле, волосы же мои, густые и длинные, как бы приклеились к траве. От подмышек до бедер я был опутан множеством тонких бечевок. Голову повернуть не удавалось, и я мог смотреть только в небо; солнце жгло мое лицо и слепило глаза. Вокруг бурлила какая-то деятельная жизнь, однако положение, в котором я находился, не позволяло понять происхождение странных звуков.
Вскоре я почувствовал, что по моей левой ноге движется что-то живое, осторожно пробирается ко мне на грудь и приближается к подбородку. Опустив глаза, я с трудом разглядел человеческое существо ростом не более шести дюймов, в руках которого находился крохотный лук, а за спиной – колчан. И тут же я понял, что вслед за этим существом по моему телу движется множество подобных созданий. От удивления я так громко вскрикнул, что незваные гости в ужасе бросились врассыпную и попáдали на землю, однако не прошло и пяти минут, как они снова вернулись. Один человечек отважился совсем близко подобраться к моему лицу, изумленно всплеснул ручонками и что-то громко прокричал остальным. Я не понял ни одного слова.
Представьте, в каком положении я находился все это время – неподвижно распластанный на земле и не имеющий возможности даже пошевелиться. В конце концов мне посчастливилось, сделав огромное усилие, порвать несколько бечевок и выдернуть колышки, к которым была привязана моя левая рука. Только поднеся ладонь к лицу, я понял, на какие хитрости пустились эти существа, чтобы связать меня. Резким рывком, причинившим мне нестерпимую боль, я несколько ослабил веревки, державшие в плену мои волосы, что позволило повернуть и немного приподнять голову. Однако мне не удалось схватить никого из человечков, потому что они мигом пустились наутек. Я услышал их пронзительные вопли и тут же почувствовал, что в мою левую руку впиваются сотни острых, словно швейные иглы, стрел. У меня было такое чувство, будто я попал в осиное гнездо, – несколько стрел вонзились мне в лицо, которое я поспешил прикрыть освободившейся рукой. Как только этот колючий ливень утих, я застонал от боли и бессильного гнева и вновь попытался освободиться, однако последовала новая атака лучников; вдобавок мучители кололи мои бока пиками и копьями. К счастью, их наконечники не могли пробить кожаную куртку, которая была на мне. Решив, что лучше не сопротивляться и спокойно дождаться наступления темноты, я вытянулся на траве. Ночью, подумал я, мне удастся освободиться от пут, а что касается этих маленьких злобных вояк, то уж с ними я как-нибудь справлюсь.
Однако судьба распорядилась иначе. Как только человечки заметили, что я успокоился, они немедленно прекратили обстрел; тем временем шум вокруг меня нарастал, и я догадался, что численность захвативших меня в плен созданий возрастает с каждой минутой. С расстояния четырех ярдов от моего правого уха до меня доносился равномерный стук, продолжавшийся около часа. Повернув голову, насколько это оказалось возможно, я скосил глаза и увидел деревянный помост высотою в полтора фута и ведущую к нему лестницу. Помост был довольно широким, но вскоре я понял, что он строился всего лишь для одного человечка.
По-видимому, меня решила навестить важная персона.
Взобравшись на помост, знатный господин три раза прокричал: «Лангро дегиль сан!» – и веревки, опутывавшие мою голову, были немедленно перерезаны. Я смог внимательно рассмотреть своего гостя. Это была особа мужского пола средних лет, ростом повыше своей свиты; один из сопровождающих, высотою в мой мизинец и по виду паж, держал шлейф вельможи, двое других почтительно замерли по обе стороны. Ко мне обратились с длинной речью, из которой я не понял ни слова, однако звучала она как речь опытного оратора. Человечек долго говорил, угрожающе жестикулируя, пока в его властном голосе не послышались благосклонные нотки; закончил он, как я понял, выражением сожаления и неопределенными обещаниями.
Я дал ему понять, что покорюсь любому его решению, при этом закатил глаза и слегка приподнял руку, как бы призывая небо в свидетели моей искренности и смирения. Меня мучили голод и жажда – в последний раз я ел за несколько часов перед тем, как покинуть корабль. Потому, вопреки этикету, я несколько раз поднес ладонь ко рту, желая показать, что умираю от голода. Гурго (так называют в Лилипутии сановников) отлично понял этот жест. Он важно спустился с помоста и тут же приказал меня накормить.
Сейчас же к моим бокам были приставлены лестницы, по которым ко мне на грудь взобралась сотня человечков с корзинами, полными разнообразной еды, – кушанья были приготовлены и доставлены сюда по приказу монарха, правителя Лилипутии, едва до него дошла весть обо мне. Человечки бодро направились к моему рту. В меню входило жаркое, но из каких именно животных, я не разобрал; все эти лопатки, окорочка и филейные части, отменно приготовленные, по вкусу напоминали баранину. Особенность моего завтрака состояла лишь в том, что любое блюдо по объему не превосходило крылышка жаворонка. Я проглатывал сразу по нескольку порций вместе с тремя хлебами, каждый из которых был не больше ружейной пули. Человечки расторопно прислуживали мне, поражаясь моему аппетиту и огромному росту.
 
Глядя на то, как стремительно пустеют корзины, слуги поняли, что малым я не удовлетворюсь, и поэтому, когда дело дошло до питья, с помощью веревок подняли самую большую бочку, подкатили к моей руке и ловко вышибли дно. Я одним духом осушил всю бочку, вмещавшую не более полупинты легкого вина, по вкусу напоминавшего наше бургундское. Вторая бочка лишь раззадорила меня, и я попросил добавки, однако, к сожалению, вино закончилось.
Все это время человечки приплясывали на моей груди и вопили: «Гекина дегуль!», показывая знаками, чтобы я ради потехи сбросил обе бочки на землю. Признаюсь, мне с трудом удалось подавить желание схватить первых попавшихся под руку весельчаков и отправить их вслед за пустыми бочками. Но я дал слово вести себя смирно и не хотел новых неприятностей. Кроме того, я считал себя связанным узами гостеприимства с этим маленьким народом, который не пожалел сил и затрат на великолепное угощение.
И следует признать – эти крохотные изобретательные существа были кем угодно, только не трусами. Я должен был казаться им гигантским чудовищем, но они с отчаянным бесстрашием взбирались на меня и разгуливали, оживленно беседуя и не обращая никакого внимания на то, что одна моя рука оставалась свободной и при желании могла бы всех их стереть в порошок.
Как только веселье поутихло, ко мне на грудь в сопровождении многочисленной свиты поднялся посланник короля. Вскарабкавшись наверх, посольство приблизилось к моей голове. Посланник предъявил верительные грамоты, скрепленные королевской печатью, поднеся их к моим глазам, и минут десять что-то энергично говорил, – видимо, здесь любили торжественные речи. В его словах не было ни малейших признаков угрозы, он обращался ко мне с достоинством, то и дело указывая куда-то вдаль; наконец я догадался, что решено доставить меня в столицу королевства, которая, как я узнал позднее, находилась на расстоянии полумили от побережья. Стараясь не задеть сановных лилипутов, я показал жестом, что все еще связан и пора бы меня освободить.
Вероятно, меня поняли, однако важная особа отрицательно покачала головой и, в свою очередь жестикулируя, пояснила, что я останусь пленником, но при этом со мной будут хорошо обращаться, кормить и поить. У меня тут же возникло непреодолимое желание освободиться самостоятельно, но воспоминание о ливне маленьких жгучих стрел, боль от которых я все еще чувствовал, охладило меня, и я покорно опустил веки. Довольные моим смирением, посланник короля и его свита любезно раскланялись и удалились под всеобщее ликование и громкие крики. Я остался лежать на траве.
Раны на лице и левой руке смазали каким-то приятно пахнущим снадобьем, которое тут же уняло боль и зуд. Затем были перерезаны путы, но только с левой стороны, и я тут же повернулся на правый бок и справил малую нужду, заставив человечков броситься врассыпную от мощного и шумного, как им казалось, потока. Сытый и довольный, вскоре я крепко уснул. Проспал я – как выяснилось потом – около восьми часов, и в этом не было ничего удивительного, потому что лилипутские медики подмешали сонного зелья в обе бочки с вином.
Дело, по-видимому, обстояло так. Как только меня нашли спящим на берегу после кораблекрушения, в столицу без промедления отправили гонца с донесением королю. Тотчас собрался государственный совет, на котором было принято решение лишить меня возможности передвигаться – что и было исполнено ночью, – затем накормить, усыпить и доставить в столицу. Такое решение на первый взгляд может показаться неразумным и слишком смелым, однако я пришел к убеждению, что в подобном случае ни один европейский государственный деятель не поступил бы столь гуманно. В самом деле: допустим, меня бы попытались убить. И что же? Почувствовав уколы от микроскопических стрел, я бы проснулся и в припадке ярости порвал путы, а затем уничтожил все живое, попавшееся мне на глаза.
Среди этого народа имелись превосходные математики и механики. Как я узнал позже, король лилипутов поощрял и поддерживал развитие наук и всяческих ремесел. В местах, где рос лес, здесь строились большие военные корабли – до девяти футов в длину. Затем корабли поднимали на специальные платформы и перевозили к морю, так что опыт сооружения транспортных средств у лилипутов имелся. Инженерам и пятистам плотникам было велено немедленно приступить к строительству крупнейшей из таких платформ. Я еще продолжал спать, когда готовая платформа уже стояла параллельно моему неподвижному телу, вызывая шумное одобрение окружающих. Она имела двадцать две пары колес и достигала семи футов в длину и четырех в ширину, возвышаясь при этом на три дюйма над землей.
Главная трудность заключалась в том, чтобы поднять меня и уложить на помост. Для этой цели – как мне позже рассказали – были вбиты в землю восемьдесят свай вышиною в фут и приготовлены прочные канаты, которые крепились крючьями к многочисленным повязкам, которыми я был спеленут, как младенец. Девятьсот отборных силачей взялись за дело и начали тянуть канаты с помощью блоков, прикрепленных к сваям. Чтобы переместить мое тело, понадобилось не меньше трех часов. Наконец меня уложили на платформу, крепко привязали, и полтысячи самых рослых лошадей, какие только нашлись в королевских конюшнях, повезли меня в столицу.
Мы находились в пути уже четыре часа, когда я проснулся – этому способствовал забавный случай. Повозка остановилась перед небольшим препятствием; воспользовавшись этим, пара молодых лилипутов из любопытства взобралась на платформу и тихонько прокралась к моему лицу. Один из них, очевидно солдат, сунул мне в ноздрю острие своей пики и принялся щекотать, словно соломинкой. Я оглушительно чихнул и открыл глаза. Храбрецов как ветром сдуло, но я проснулся и мог наблюдать все, что в дальнейшем происходило вокруг.
Когда стемнело, мы расположились передохнуть. Но и тогда меня строго охраняли при свете факелов и не давали возможности даже пошевелиться. На рассвете повозка-платформа со скрипом тронулась в путь и уже к полудню находилась в двухстах ярдах от городских ворот. Король и весь двор вышли нам навстречу, однако его величеству в целях безопасности посоветовали не подниматься на мое обездвиженное тело.
На площади, где остановился наш караван, возвышался огромный древний храм. Несколько лет назад этот храм был осквернен убийством, и с тех пор жители столицы перестали ходить туда на службы. Храм закрыли, вынесли из него все убранство, и он долго стоял пустым. В этом здании и решено было меня поместить.
Широкий вход в бывшее святилище давал мне возможность свободно вползти внутрь, что я и сделал, когда меня освободили от дорожных пут. По обе стороны двери на расстоянии каких-нибудь семи дюймов от земли были расположены два оконца; в одно из них придворные кузнецы пропустили девяносто одну цепочку вроде тех, на которых наши европейские дамы носят свои часики. К моей левой ноге приковали миниатюрные цепи с тридцатью шестью висячими замочками. Напротив моей тюрьмы на расстоянии двадцати футов стояла башня, куда взошел король вместе с придворными, чтобы понаблюдать за мной, – сам же я его не видел. Около ста тысяч лилипутов с той же целью покинули свои дома. Наконец, убедившись, что бежать отсюда я не смогу, меня оставили в покое.
В самом скверном расположении духа я поднялся на ноги и повел плечами, разминая онемевшие мышцы. Тут-то и выяснилось, что прикованные к моей ноге цепочки длиною около двух ярдов позволяют мне не только выходить из храма наружу и прохаживаться, описывая полукруг, но и, вернувшись, без помех укладываться на полу во весь рост.
Пришло время осмотреться, что я и сделал. Окрестности храма представляли собой сплошной пышный сад, а огороженные поля, каждое из которых занимало не более сорока квадратных футов, напоминали цветочные клумбы. Поля чередовались с лесом, где самые высокие деревья, насколько я мог судить, достигали лишь семи футов. Слева лежал город, похожий на пестро раскрашенную театральную декорацию.
Пока я любовался этой необычной картиной, король уже спустился с башни и верхом на лошади направился в мою сторону, едва не поплатившись за подобную смелость. Его отменно выезженный конь при виде меня испугался – вероятно, ему показалось, что на него движется гора. Животное взвилось на дыбы, но король, будучи превосходным наездником, сумел удержаться в седле, пока подбежавшие слуги не схватили коня под узцы и не помогли всаднику сойти. Утвердившись на ногах и сохраняя полное спокойствие, его величество внимательно рассмотрел меня со всех сторон, впрочем не приближаясь. Затем он велел меня накормить и напоить, что тут же было исполнено. Лакеи, бывшие наготове, подкатывали тележки с провизией на расстояние моей вытянутой руки; я быстро опорожнил двадцать тележек с разнообразными кушаньями и десять с винами. Королева, молодые принцы и принцессы вместе с придворными дамами окружили короля, и теперь вся компания наблюдала за мной, затаив дыхание.
О правителе Лилипутии хотелось бы сказать особо, так как позже я с ним неоднократно встречался, а разобравшись в лилипутском наречии, подолгу беседовал, для чего мне приходилось ложиться на бок, а он располагался всего в трех ярдах от моего лица. Когда мы подружились, я даже сажал его величество на ладонь, где король бесстрашно расхаживал, продолжая разговор. Он вполне был достоин своего положения и благополучно правил страной уже более семи лет, окруженный любовью подданных.
Внешность короля была примечательной. Росточком он был повыше своих придворных, с внушительной осанкой, с мужественными и строгими чертами округлого лица. Нос крючковатый, кожа оливковая, нижняя губа слегка оттопырена. Осанка его пропорционально сложенного тела была величественной, движения сдержанными и грациозными. Король уже переступил границу цветущей молодости, однако от него веяло отменным здоровьем и силой. Его одежда была скромной, обычного покроя – нечто среднее между азиатским и европейским стилем; королевскую голову украшал легкий золотой шлем, усыпанный драгоценными камнями, а в руке он держал обнаженную шпагу длиною около трех дюймов, на ножнах и эфесе которой сверкали мелкие бриллианты. Голос у его величества оказался пронзительный, чистый и до такой степени внятный, что даже стоя я мог без труда различать произносимые им слова.
В отличие от короля, придворная свита – а в особенности дамы – были настолько пышно разодеты, что, собравшись вместе, походили на волнующуюся ткань, расшитую золотыми и серебряными узорами.
Наконец его величество, приблизившись, начал задавать вопросы, на которые я пытался отвечать, но, увы, из нашего диалога ничего не вышло – мы совершенно не понимали друг друга. Короля сменили, судя по одежде, священник и юридическое лицо – теперь им было поручено вступить со мной в разговор. Я пробовал говорить на всех языках, с которыми был хоть немного знаком, начал с латыни и закончил немецким, французским и голландским, но все это ни к чему не привело.
Спустя два часа разочарованный королевский двор неспешно удалился, и я был оставлен под усиленным караулом; меня охраняли в первую очередь от любопытствующей и возбужденной толпы лилипутов. Кое у кого из них хватило бесстыдства обстрелять меня из лука, как только я устроился на земле у входа; одна стрела едва не угодила мне в глаз. Рассерженный начальник стражи приказал арестовать стрелков и не придумал ничего лучше, чем, связав, отдать их мне для наказания. Солдаты, толкая несчастных перепуганных преступников в спину древками пик, подогнали их к моим ногам. Я наклонился, сгреб шестерых человечков в руку и положил всех, кроме одного, в карман камзола. Последнего я поднес ко рту, в шутку сделав вид, что хочу им закусить. Бедняга отчаянно завизжал, а стража пришла в сильнейшеее беспокойство, увидев в моих руках еще и нож. Я быстро их успокоил – с ласковой улыбкой посмотрев на пленника, я разрезал связывавшие его веревки и осторожно поставил на землю. Он мигом дал деру. Точно так же я поступил и с остальными лилипутами, по очереди вынимая их из кармана. Толпа пришла в восторг; о случившемся тут же доложили королю, и мое милосердие произвело огромное впечатление при дворе.
С наступлением темноты я не без труда вполз в свою конуру и улегся на каменном полу. И пока для меня изготовлялась постель, мне пришлось в течение двух недель коротать ночи подобным образом. Наконец на повозках доставили шестьсот лилипутских матрасов и внесли их в храм; работа началась. Сто пятьдесят штук сшили вместе – так и образовался один огромный матрас, подходящий для меня. Когда были готовы все четыре, их сложили один на другой, и все-таки мое ложе оставалось ненамного мягче каменных плит. Простыни и одеяла изготовили тем же способом, и они оказались вполне сносными для человека, давно привыкшего к лишениям.
Едва весть обо мне разнеслась по королевству, как отовсюду в столицу начали стекаться любопытные. Близлежащие деревни опустели, полевые работы приостановились, хозяйственные дела пришли в упадок. Все это продолжалось бы еще долго, если бы король своими указами не пресек паломничество. Так, он распорядился, чтобы те, кто уже взглянул на меня, без промедления возвращались домой. Все прочие должны были получать особое платное разрешение в канцелярии, что значительно пополнило королевскую казну.
Между тем сам король все чаще собирал совет, на котором обсуждалась моя судьба. Позднее я узнал от одной знатной особы, посвященной в государственные тайны, что двор находился в большом затруднении и мнения разделились. Одни опасались моего бегства и утверждали, что мое содержание окажется тяжким бременем для страны. Другие намеревались уморить меня голодной смертью или советовали поскорее отправить на тот свет с помощью отравленных стрел. Противники подобного решения возражали, упирая на то, что разложение такого громадного покойника может вызвать чуму, с которой лилипутам не совладать. Именно в разгар этого спора и явились несколько офицеров из приставленной ко мне охраны, чтобы сообщить о моем благодушном нраве и гуманном поступке по отношению к шестерым слабоумным, которые в меня стреляли.
Король Лилипутии при поддержке всего государственного совета немедленно подписал указ, который обязывал жителей деревень, находившихся в радиусе девятиста ярдов от столицы, каждое утро доставлять на королевскую кухню шесть быков, сорок баранов и другую провизию для моего стола, не забывая о хлебе, вине и чистой воде для питья. Все это оплачивалось из средств его величества. Замечу, что король Лилипутии жил на доходы от своих владений, лишь в редких случаях обращаясь за финансовой помощью к подданным, которые охотно откликались на его просьбы.
Был назначен штат прислуги в шестьсот человек. Для них поставили удобные палатки по обе стороны от входа в мое жилище, платили жалованье и кормили. Далее последовал указ его величества о том, чтобы три сотни портных сшили для меня костюм местного фасона, а полдюжины знаменитых профессоров занялись моим обучением языку лилипутов. И наконец, решено было как можно чаще тренировать лошадей из королевской конюшни и конюшен королевской гвардии прямо на площади перед храмом, где я обитал, чтобы животные больше не пугались моей громадной фигуры.
Все указы его величества были надлежащим образом исполнены.
Спустя три недели я уже начал делать успехи в освоении лилипутского языка. В течение этого времени король часто навещал меня; особенно ему нравилось присутствовать на уроках – он вслушивался в мой голос и одобрительно кивал головой. Вскоре я попробовал беседовать с его величеством, и первыми словами, которые я выучил, была просьба даровать мне свободу. Стоя на коленях, каждую нашу встречу я начинал с этой фразы – в качестве приветствия.
Король, однако, отвечал уклончиво. Насколько я смог понять, вопрос о моем освобождении он считал делом времени – один он не мог принять столь ответственное решение без согласия государственного совета. Прежде всего я должен поклясться хранить мир с самим королем и всеми его подданными. Звучала эта тарабарщина приблизительно так: «Люмоз кельмин пессо деемарлон эмпозо!» Тем не менее, продолжал король, ко мне и без того будут относиться благосклонно, а терпением и примерным поведением я сумею заслужить уважение его страны.
В один из своих визитов его величество, немного сконфузившись, заявил, что меня необходимо обыскать, поскольку крупные предметы, имеющиеся при мне, могут представлять опасность. «Мы не хотим вас оскорбить, – добавил он, – но таковы наши правила». Я с улыбкой ответил, что могу сейчас же раздеться и вывернуть все карманы, но король пояснил, что, согласно закону, обыск должны произвести два специальных чиновника и на то необходимо мое согласие. Зная мое благородство и великодушие, он спокойно передает чиновников в мои руки; все, что будет изъято, мне возвратят в тот же миг, как я покину Лилипутию, или же будет куплено по назначенной мною цене. Я кивнул; его величество хлопнул в ладоши, и ко мне приблизились два строгих лилипута.
Наклонившись, я бережно поднял обоих служителей правосудия и отправил их для начала в карманы куртки. Затем, когда они закончили осмотр, переложил в остальные, кроме двух потайных карманчиков на жилете и еще одного. Там были вещи никому, кроме меня, здесь не нужные: серебряные часы, кошелек и прочая мелочь. После обыска суровые джентльмены велели мне спустить их на землю и составили подробную опись всего обнаруженного в моих карманах, которую и представили королю. Со временем я перевел этот документ на английский:
«В правом кармане куртки Человека Горы после самого тщательного осмотра мы обнаружили лишь огромный кусок грубого холста, по размеру равный ковру в парадном зале дворца Вашего Величества. В левом кармане находился тяжелый серебряный сундук с крышкой из того же металла, которую мы не смогли даже приподнять. По нашему требованию сундук был открыт; один из нас залез в него, погрузившись в пыль неизвестного происхождения, вызвавшую сильнейшее чихание.
В правом кармане жилета находилась связка тонких листов белой бумаги, покрытых черными знаками. Предполагаем, что это – не что иное, как письмена, каждая буква которых по высоте равняется нашей ладони. Левый жилетный карман содержал особый предмет с двадцатью длинными жердями по краю, очень напоминающий ограду перед дворцом Вашего Величества. По красноречивым жестам Человека Горы мы поняли, что этим предметом он расчесывает свои длинные волосы.
В большом кармане штанов мы обнаружили огромный деревянный футляр, в котором был спрятан загадочный инструмент, содержащий острое лезвие опасного вида. Подобный футляр, где находился предмет из черного дерева величиною с колонну, куда вставлена стальная пластина, мы нашли в левом кармане. Полагая, что обе эти находки подозрительны, мы обратились к Человеку Горе за разъяснениями. Великан достал предметы из футляров и пояснил нам, что одним в его стране бреют бороду и усы, а другим – режут мясо за обедом.
Два полых железных столба неправильной формы, обнаруженных за поясом Человека Горы, мы также решили причислить к разряду невиданных доселе предметов.
В небольшом правом кармане штанов находилось много гладких дисков из белого, красного и желтого металла различной величины; они так тяжелы, что их едва удается поднять. И если те из них, что сделаны из желтого металла, действительно золотые, как утверждает Человек Гора, они должны представлять огромную ценность.
Кроме того, мы обнаружили еще и такие карманы, куда не смогли проникнуть. Из одного спускалась серебряная цепь, прикрепленная к тому, что лежало внутри. Мы потребовали показать нам этот предмет. Человек Гора подчинился, вынул диковинную машину и поднес ее к нашим ушам – послышался непрерывный шум и стук, сродни шуму колеса водяной мельницы. Внешне загадочный предмет оказался похож на приплюснутый шар; нижняя часть его сделана из белого металла, а верхняя – из прозрачного твердого вещества, сквозь которое виднеются некие знаки. Мы склоняемся к мысли, что внутри шара находится почитаемое Человеком Горой божество, так как он утверждает, что всегда советуется с обитателем шара, указывающим время на протяжении всей его жизни.
Тщательно осмотрев все карманы, мы перешли к дальнейшему обыску и исследовали кожаный пояс на талии Человека Горы. К поясу с одной стороны прикреплена сабля длиною в пять раз более человеческого роста, а с другой – сумка из двух отделений, в каждом из которых может поместиться трое подданных Вашего Величества. Там находилось множество шаров из чрезвычайно тяжелого металла: каждый шар величиной почти с нашу голову; кроме того, были обнаружены черные зерна, довольно мелкие и легкие. На ладони их помещается до пятидесяти штук.
Такова точная и подробная опись всего, что найдено нами при досмотре Человека Горы. Пока шел обыск, он держал себя вежливо и с должным почтением, каковое подобает оказывать доверенным лицам Вашего Величества.
Скреплено подписью и приложением печати в четвертый день восемьдесят девятой луны благополучного царствования короля Лилипутии.
Ознакомившись с этим документом, король обратился ко мне с просьбой предъявить некоторые предметы, упомянутые в нем. Сначала его заинтересовала сабля. Меня окружили три тысячи гвардейцев с луками наизготовку, а его величество велел мне обнажить оружие, которое, как я знал, местами заржавело от морской воды. Однако, когда я вынул саблю из ножен и продемонстрировал королю, лезвие ярко сверкнуло на солнце. Гвардейцы попятились и испустили дружный вопль, но король и бровью не повел, приказал мне вложить саблю в ножны и бросить на землю в шести футах от моей цепи. Затем он попросил показать то, что было обозначено как «два полых железных столба неправильной формы». Я достал из-за пояса один из пистолетов (а это и была именно пара моих пистолетов) и, как мог, объяснил его устройство и назначение. Потом я зарядил пистолет холостым зарядом – благодаря плотно закупоренному патронташу порох остался сухим – и, предупредив его величество, выстрелил в воздух. На этот раз сотни его вояк рухнули, словно пораженные громом, а сам король лилипутов, хотя и устоял на ногах, но долго не мог прийти в себя. Я отдал ему пистолеты, патронташ с пулями и порохом, однако попросил держать порох как можно дальше от огня, так как при малейшей искре он может вспыхнуть и королевский дворец взлетит на воздух.
Мне пришлось расстаться и с любимыми часами, которые король рассматривал с нескрываемым любопытством. Он был поражен ходом часового механизма и движением минутной стрелки. Его величество пожелал выслушать мнение своих ученых, однако те так и не смогли дать вразумительных объяснений. Тогда король распорядился, чтобы пара самых дюжих гвардейцев унесла драгоценный предмет. Надев часы на шест и вскинув его на плечи, они тотчас отправились во дворец.
Я показал, доставая из карманов по очереди, серебряные и медные деньги, кошелек с десятью золотыми, нож, бритву, гребень, серебряную табакерку, платок и записную книжку. Моя сабля, пистолеты и пантронташ были отправлены на повозках в арсенал его величества. Остальное было возвращено мне.
Потайной карманчик я никому не показал – там у меня лежали очки, я пользовался ими при чтении. Подзорную трубу и кое-что еще я также скрыл. Для короля это не имело особого значения; кроме того, я опасался, что нужные мне вещицы затеряются или их испортят слишком любознательные лилипуты.
Моя кротость и примерное поведение вызвали такую симпатию у короля, двора, всего народа и даже армии, что во мне затеплилась надежда на скорое освобождение из почетного плена. Я грезил свободой и старался заслужить еще большее доверие к себе. Меня уже не боялись; я довольно сносно понимал лилипутский язык и говорил на нем. Иногда, лежа на земле, я позволял веселым человечкам плясать на моей руке, а дети часто играли в прятки в моих волосах.
Однажды королю захотелось развлечь меня красочными ярмарочными празднествами. На мой взгляд, акробаты в этой стране своей ловкостью и мастерством превосходят всех остальных циркачей в мире, но больше всего меня заинтересовали канатоходцы. Вообразите себе тонкую белую нить в два фута длиной, натянутую на высоте двенадцати дюймов от земли, и пляшущих на ней человечков. В таких представлениях участвуют только те лилипуты, которые являются кандидатами на государственные должности или ищут благосклонности королевского двора. Они обучаются этому искусству с юных лет и упорно совершенствуются, отказывая себе в личной жизни. И когда открывается вакансия на высокую должность, несколько соискателей подают на имя короля прошение – позволить им дать представление в присутствии его величества и всего двора. Кандидаты танцуют на канате, и тот, кто прыгнет выше остальных и при этом не упадет на землю, занимает желаемую должность. Иногда первые министры вынуждены подтверждать свое искусство, чтобы убедить короля в том, что они не утратили своего таланта. Так, Флимнап, государственный казначей, был известен своей прыгучестью: он совершил пируэт на канате, повторить который не удалось ни одному другому сановнику во всем королевстве. Я наблюдал его опасные прыжки, когда он тренировался. Рельдресель, государственный секретарь и глава министерства иностранных дел, мой приятель, – если, конечно, наши с ним отношения можно назвать приятельскими, – занимал второе место после государственного казначея. Остальные сановники также находились на высоком уровне в искусстве хождения над пропастью.
Такие представления нередко сопровождаются роковыми происшествиями и несчастьями. Я сам видел нескольких изувеченных кандидатов-неудачников. Но особая опасность подстерегает министров и государственных чиновников, демонстрирующих свою ловкость королю. Так, еще до моего прибытия сэр Флимнап едва не сломал себе шею, но его спасла случайно лежавшая под канатом одна из королевских подушечек.
Ежедневно в моем присутствии конюхи гвардейских и королевских конюшен объезжали на площади лошадей. Вскоре кони без страха уже подходили так близко ко мне, что однажды, когда я опустил руку на землю, некоторые всадники умудрились въехать на нее. Однако больше всех отличился королевский егерь, который с легкостью перепрыгнул на своей лошади через мою обутую в башмак ногу – будто брал барьер. Это был поистине поразительный прыжок.
Как-то мне пришло в голову необычное развлечение для короля. Я попросил доставить дюжину палок длиною в два фута и толщиною в обычную трость, и через день моя просьба была выполнена королевским лесничим. Я взял бóльшую часть палок и крепко вбил их в землю в виде четырехугольника, а сверху туго натянул свой носовой платок. Из остального материала я сделал нечто вроде барьера. Закончив работу, я предложил королю выделить двадцать четыре лучших кавалериста для упражнений на этом плацу. Затем, подняв поочередно каждого всадника в полном вооружении вместе с лошадью, я поставил их на платок. Построившись, кавалеристы разделились на два отряда, и военные действия начались. Король пришел в такой восторг, что еще не раз просил меня повторить эти маневры, и однажды сам пожелал подняться на плац, чтобы командовать войсками. Королеве эти забавы были не по душе, однако и она изредка наблюдала блестящее представление, сидя в носилках на расстоянии двух ярдов от площадки. К счастью, маневры окончились благополучно; лишь одна горячая лошадь пробила дыру в платке и, оступившись, упала, подмяв седока. Я тут же пришел ему на помощь. Упавшая лошадь вывихнула левую переднюю ногу, но всадник не пострадал.
Незадолго до моего освобождения, в то время как я, скучая, развлекал себя и королевский двор всякими фокусами, к его величеству прибыл гонец с известием, что около того места на берегу, где я был пленен, найден неподвижно лежащий громадный черный предмет странной формы. Предмет имеет круглое основание, по площади равен покоям его величества, крыша предмета плоская, а внутри – пустота. Я тотчас догадался, что речь идет о моей потерянной шляпе, и упросил короля доставить ее в столицу. Он любезно дал согласие, однако, когда шляпа попала ко мне в руки, ее состояние оказалось крайне плачевным. Лилипуты волокли ее от самого берега до города при помощи крючьев и веревок и проделали в полях многочисленные дыры.
Спустя пару дней после этих событий его величеству пришла в голову еще одна странная забава. Был отдан приказ о приведении в полную готовность конных и пехотных полков, стоявших в столице и ее окрестностях. Король попросил меня замереть на площади, широко расставив ноги. Затем войска сомкнули ряды и торжественным маршем прошли подо мной – пехота по двадцать четыре человека в ряд, а кавалерия по шестнадцать, – с барабанным боем, развернутыми знаменами и пиками наперевес. Было приказано, чтобы во время парада, под страхом самого сурового наказания, войска сохраняли почтение по отношению ко мне. Однако сам я с ужасом думал о плачевном состоянии своих старых панталон, – и действительно, проходя между моими ногами, некоторые офицеры украдкой поднимали вверх глаза и отпускали непристойные шуточки…
Я подал в королевскую канцелярию столько прошений и докладных о моем освобождении, что в конце концов король вынес этот вопрос на обсуждение кабинета министров, а затем и государственного совета. Никто не выразил протеста, кроме Скайреша Болголама, который без всякой причины воспылал ко мне ненавистью. Но, несмотря на все его усилия, дело было решено и утверждено королем в мою пользу. Болголам занимал пост гальбета, – другими словами, адмирала королевского флота, пользовался доверием его величества и был человеком хоть и сведущим в своем деле, но грубым и со странностями. Нехотя согласившись на мое освобождение, он добился, чтобы ему было поручено предъявить условия, на которых я наконец-то обрету свободу. Бумагу адмирал доставил мне лично в сопровождении двух секретарей и нескольких знатных особ. Когда указ короля был оглашен, с меня взяли присягу, что я не нарушу ни единого пункта. Вначале я присягнул по обычаям своей страны, а затем должен был повторить клятву по лилипутским правилам.
Обретя свободу, я прежде всего попросил разрешения осмотреть Мильдендо, столицу Лилипутии. Король охотно согласился, но велел строго соблюдать осторожность по отношению к горожанам и их жилищам. Столичное население тут же оповестили.
Вся столица была огорожена стеною высотой в два с половиною фута и толщиной не менее одиннадцати дюймов. Лилипуты могли совершенно свободно проехать по ней в карете, запряженной парой лошадей. По углам стены на расстоянии десяти футов одна от другой высились крепкие башни. Перешагнув через главные Западные ворота, я снял сюртук, чтобы не задеть полами крыши и карнизы домов, и осторожно прошел по двум центральным улицам. Несмотря на строгий приказ укрыться в домах и не покидать их до конца моей прогулки, беспечные жители столицы сновали у меня под ногами. Я с большой осторожностью продвигался вперед, стараясь никого не раздавить. В открытых окнах верхних этажей, на балкончиках и крышах замерли любопытные; у меня сложилось впечатление, что город слишком плотно населен.
Столица Лилипутии на плане походила на правильный четырехугольник, каждая сторона которого равна пятистам футам; две главные улицы шириною в пять футов каждая пересекались под прямым углом и разделяли город на четыре части. Небольшие боковые улочки и переулки, в которые я не мог пробраться, по ширине составляли от двенадцати до восемнадцати дюймов. Город мог вместить до пятисот тысяч человек; дома в основном были трех– и пятиэтажные, а лавки и рынки полны всевозможных товаров.
Королевский дворец находился в центре столицы и был расположен на перекрестке главных улиц. Его окружала стена в два фута высотой, отстоявшая от тыльной части дворца и служебных построек на двадцать футов, а со стороны площади, куда выходил фасад, – на восемь футов. Я получил разрешение его величества перешагнуть через стену и благодаря свободному пространству позади зданий мог осмотреть их со всех сторон.
Королевские покои находились в глубине обширного квадратного внутреннего двора, и чтобы попасть туда, – а мне очень хотелось их осмотреть, – нужно было пройти через главные ворота вышиною всего лишь в восемнадцать дюймов и семь дюймов в ширину. Я мог бы их перешагнуть, но боялся разрушить каменные постройки, хоть и прочные, однако стоящие слишком тесно. Король очень хотел показать мне свой великолепный дворец, но лишь спустя три дня мне удалось выполнить его желание.
В королевском загородном парке я срезал ножом несколько самых крупных деревьев и смастерил из них два табурета высотой около трех футов, которые могли бы выдержать мой вес. Подойдя к резиденции короля со стороны площади, я встал на один табурет, поднял другой над крышами построек и осторожно поставил на свободное место. Затем перешагнул через здания с одной табуретки на другую. Теперь, присев на корточки, я мог внимательно рассмотреть внутреннее убранство дворца, а также всех его обитателей.
Мне удалось увидеть всю королевскую семью и даже поцеловать ручку королевы, грациозно и милостиво протянутую мне из окна.
Полюбовавшись красотами дворца, я с помощью тех же табуретов благополучно выбрался на площадь и вернулся к себе.
Однажды утром, примерно через пару недель после моего освобождения, ко мне явился Рельдресель в сопровождении слуги. Велев кучеру ждать, государственный секретарь попросил выслушать его и предпочел во время нашего разговора оставаться на моей ладони. Я охотно согласился из уважения к его личным достоинствам и в благодарность за хлопоты о моей судьбе перед королем. Мне было хорошо известно, что ни одно важное дело в королевстве не проходило без его ведома.
Прежде всего Рельдресель поздравил меня с освобождением, добавив, что своей свободой я обязан особому стечению обстоятельств в государственных делах.
«Каким бы блестящим ни казалось чужеземцу наше положение, – продолжал мой гость, – мы страдаем от двух страшных зол: от внутренних раздоров и от угрозы нападения коварного и сильного противника. Первое связано с тем, что около семидесяти лун тому назад в королевстве возникли две враждующие партии. Партия тремексенов объединила сторонников высоких каблуков, слемексены же объявили себя приверженцами низких. Возможно, вы, друг мой, заметили, – спросил государственный секретарь с легкой усмешкой, – что подданные его величества обуты в башмаки, имеющие каблуки разной высоты?»
Я кивнул.
«Тремексены утверждают, – продолжал он, – что обязательное ношение высоких каблуков было навечно закреплено нашей первой Конституцией. Однако нынешний король – сторонник низких каблуков, и он постановил особым указом, чтобы все служащие правительственных и придворных учреждений носили исключительно низкие каблуки. И это вы тоже заметили, как и то, что у его величества каблуки на башмаках на один дрерр, или четырнадцатую часть дюйма, ниже, чем у придворных. Вражда между обеими партиями доходит до того, что члены одной не могут находиться за общим обеденным столом с членами другой. Тремексены многочисленны, однако не имеют в руках власти. В то же время у нас появилось подозрение, что наследник престола симпатизирует этой партии, – нетрудно заметить, что один его каблук выше другого, вследствие чего его высочество прихрамывает… И вот на фоне этих внутренних раздоров близится беда извне – со стороны соседнего острова Блефуску…»
Рельдресель сделал паузу и внимательно посмотрел на меня.
«Вот вы утверждаете, – вздохнул он, – что на свете существуют другие королевства и государства, где живут такие же великаны, как вы. Однако наши ученые сомневаются в этом и склонны придерживаться гипотезы, что вы, мой уважаемый друг, скорее всего, свалились с неба. Кроме того, имеются летописи и исторические документы, в которых за период в шесть тысяч лун не упоминается ни одно государство, кроме великого королевства Лилипутии и империи Блефуску… Мы соседствуем с этим островным государством, однако в течение уже тридцати шести лун нам приходится вести с ним ожесточенную войну. Поводом для нее послужило следующее событие. Всем известно, что с незапамятных времен яйца всмятку полагается разбивать с тупого конца. Случилось так, что дедушка его величества, еще будучи ребенком, за завтраком порезался острым осколком скорлупы, разбив яйцо, которое ему подали. Его батюшка, прадед нашего короля, издал указ, предписывающий всем лилипутам разбивать яйца исключительно с острого конца… И что бы вы думали? Этот указ вызвал такое возмущение среди населения, что началась смута, которая переросла в настоящую революцию. Летописи упоминают о шести восстаниях, во время которых пострадали даже королевские особы. Около одиннадцати тысяч фанатиков были приговорены к смертной казни за отказ разбивать яйцо с острого конца.
Правители Блефуску упорно поддерживали и поощряли народные волнения, укрывая бунтовщиков в своих владениях. Там печатались прокламации и даже брошюры. В Лилипутии движение тупоконечников было давным-давно запрещено, его сторонники лишились права занимать государственные должности, а их книги преданы огню… Все еще больше осложнилось, когда с острова Блефуску в нашу сторону прозвучали обвинения в ереси и расколе. Мы, по утверждению их теологов, исказили основной догмат нашего великого общего пророка Люстрога. В пятьдесят четвертой главе духовной «Книги Алкорана» сказано: «Все истинно верующие да разбивают яйца с того конца, с какого удобнее». А какой конец – тупой или острый – считать удобным? Как по мне, так это личное дело каждого верующего. В общем, началась полемика, сопровождаемая теперь уже религиозными волнениями, были написаны и отпечатаны сотни томов, посвященных этому вопросу, однако все оказалось без толку и отношения между нашими странами окончательно испортились. А изгнанники-тупоконечники нашли убежище в империи Блефуску и приобрели огромное влияние на тамошних правителей.
И вот эта ужасная война тянется уже тридцать шесть лун, и ни одна из враждующих сторон не добилась решающей победы. За это время мы потеряли сорок линейных кораблей и огромное число мелких судов, пятьдесят тысяч моряков и солдат погибли. Думаю, что потери противника не меньше, если не больше. Однако, по донесениям тайных агентов, неприятель снаряжает новый флот, чтобы высадить десант на побережье нашего королевства. Его величество, король Лилипутии, полагаясь на вашу силу и храбрость, повелел мне обрисовать вам истинное положение дел…»
Я поблагодарил госсекретаря за оказанное доверие и просил передать его величеству мое глубочайшее почтение.
«Доведите до сведения короля, – сказал я своему гостю, – что хотя мне как иностранному подданному не следовало бы вмешиваться во внутренние дела чужого государства, однако я в долгу у его величества за спасение и дарованную мне свободу. Я готов не щадя жизни защищать его особу и всех лилипутов от любого врага, грозящего вторжением в пределы королевства!»`

func main() {
	l.Info("Started")
	fn := "./bin/bash.json"

	bp := utils.NewBashParser(fn, logrus.InfoLevel)
	msgc, errc := bp.Start()
	go func() {

		l.Info("Started listening to errors")
		for err := range errc {
			l.WithError(err).Error("got error from parser")
		}
	}()

	c := markov.NewChain()
	l.Info("Ranging throught channel")
	for msg := range msgc {
		_ = c.ParseText(msg)
	}
	c.CalculateCells()
	// c.Iterate()

	l.Println("Ready to accept messages")
	sc := bufio.NewReader(os.Stdin)
	for {
		msg, err := sc.ReadString('\n')
		if err != nil {
			l.WithError(err).Error("can't read from stdin")
			break
		}
		if msg == "end\n" {
			break
		}
		msg = getNewMsg(c)
		l.Println(msg)
	}

	os.Exit(0)
}

func getNewMsg(c *markov.Chain) string {
	txts := make([]string, 0)
	prev := "*START*"
	cnt := 0
	for msg, err := c.GetNextWord(prev); ; msg, err = c.GetNextWord(prev) {
		cnt++
		t := msg.GetWord()
		tp := msg.GetType()
		txts = append(txts, t)
		prev = t
		if tp == markov.End {
			break
		}
		if err != nil {
			// fmt.Println(err)
			break
		}
		if cnt > 30 {
			break
		}
		// fmt.Printf("Word: %s\tType: %d\n", t, tp)
	}
	txt := strings.Join(txts[:len(txts)-1], " ")
	txt = strings.Replace(txt, "*END*", ".", -1)
	txt = txt + "."
	return fmt.Sprintf("%s\n", txt)
}
